#!/usr/bin/env bash

set -eo pipefail

# shellcheck source=./bin/docker-compose
source "$(dirname "${BASH_SOURCE[0]}")/docker-compose"

# Get current ngrok url from ngrok api launched with command "make ngrok"
if $dockercompose port ngrok 4040 &> /dev/null ; then
    declare -r JQ="docker run --rm -i fundocker/jq:1.6"
    curl --no-progress-meter "$($dockercompose port ngrok 4040)/api/tunnels/command_line" | \
    ${JQ} .public_url  | \
    sed 's/"//g'
fi
